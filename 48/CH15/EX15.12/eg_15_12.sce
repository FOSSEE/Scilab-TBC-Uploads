clc;
clear;
A=[1 0 0 0;
   0 0 1 1;
   1 1 0 0;
   1 0 1 0];
B=[1 0;
   0 0;
   1 1;
   1 1];
C=[0 1 0 1;
   1 1 1 0];
D=[1 0;
   0 1];
K=[C;C*A;C*(A*A)];
K=modulo(K,2);
T=K(1:3,:);
Q=K(1:3,1:3);
Q_inv=inv(Q);
Q_inv=abs(modulo(Q_inv,2));
R=[Q_inv;[0 0 0]];
disp("Reduced matrix A is");
disp(A_red=T*A*R);
disp("Reduced matrix B is");
disp(B_red=T*B);
disp("Reduced matrix C is");
disp(C_red=C*R);
disp("Reduced matrix D is");
disp(D_red=D);