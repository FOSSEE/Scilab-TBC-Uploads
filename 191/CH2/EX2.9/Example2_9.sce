//Solving four linear system of equations with Gauss-Seidel and SOR method 
//the convergence is much faster in SOR method

clear;
close();
clc;
format('v',7);
x1=[0,0];
x2=[0,0];
x3=[0,0];
x4=[0,0];
x1(1,2)=-0.33333*(1-x2(1,1)-3*x4(1,1));
x2(1,2)=0.16667*(1-x1(1,2)-x3(1,1));
x3(1,2)=0.16667*(1-x2(1,2)-x4(1,1));
x4(1,2)=-0.33333*(1-3*x1(1,2)-x3(1,2));
i=1;
while (abs(x1(1,1)-x1(1,2))>0.5*10^-2 | abs(x2(1,1)-x2(1,2))>0.5*10^-2 | abs(x3(1,1)-x3(1,2))>0.5*10^-2 | abs(x4(1,1)-x4(1,2))>0.5*10^-2)
    x1(1,1)=x1(1,2);
    x2(1,1)=x2(1,2);
    x3(1,1)=x3(1,2);
    x4(1,1)=x4(1,2);
    x1(1,2)=-0.33333*(1-x2(1,1)-3*x4(1,1));
    x2(1,2)=0.16667*(1-x1(1,2)-x3(1,1));
    x3(1,2)=0.16667*(1-x2(1,2)-x4(1,1));
    x4(1,2)=-0.33333*(1-3*x1(1,2)-x3(1,2));
    i=i+1;
end
disp([x1; x2; x3; x4],'Answers are:')
disp(i,'Number of Iterations :')


w=1.6;
x1=[0,0];
x2=[0,0];
x3=[0,0];
x4=[0,0];
x1(1,2)=x1(1,1)-0.33333*w*(1+3*x1(1,1)-x2(1,1)-3*x4(1,1));
x2(1,2)=x2(1,1)+0.16667*w*(1-x1(1,2)-6*x2(1,2)-x3(1,1));
x3(1,2)=x3(1,1)+0.16667*w*(1-x2(1,2)-6*x3(1,2)-x4(1,1));
x4(1,2)=x4(1,1)-0.33333*w*(1-3*x1(1,2)-x3(1,2)+3*x4(1,1));
i=1;
while (abs(x1(1,1)-x1(1,2))>0.5*10^-2 | abs(x2(1,1)-x2(1,2))>0.5*10^-2 | abs(x3(1,1)-x3(1,2))>0.5*10^-2 | abs(x4(1,1)-x4(1,2))>0.5*10^-2)
    x1(1,1)=x1(1,2);
    x2(1,1)=x2(1,2);
    x3(1,1)=x3(1,2);
    x4(1,1)=x4(1,2);
    x1(1,2)=x1(1,1)-0.33333*w*(1+3*x1(1,1)-x2(1,1)-3*x4(1,1));
    x2(1,2)=x2(1,1)+0.16667*w*(1-x1(1,2)-6*x2(1,2)-x3(1,1));
    x3(1,2)=x3(1,1)+0.16667*w*(1-x2(1,2)-6*x3(1,2)-x4(1,1));
    x4(1,2)=x4(1,1)-0.33333*w*(1-3*x1(1,2)-x3(1,2)+3*x4(1,1));
    i=i+1;
end
disp([x1; x2; x3; x4],'Answers are :')
disp(i,'Number of Iterations :')