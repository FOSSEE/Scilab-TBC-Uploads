//Example 15.7, page 547